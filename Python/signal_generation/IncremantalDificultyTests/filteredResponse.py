# Seting upp libraries
import os
import sys

SCRIPT_DIR = os.path.dirname(os.path.abspath(__file__))
sys.path.append(os.path.dirname(SCRIPT_DIR))

import matplotlib.pyplot as pyplot

# Filtered signal
signal = [
982, 814, 2340, 852, 5426, -6852, 2316, -988, 588, 1128, 642, -1566, 1568, -450, -262, -666, 362, -128, 344, -2204, 2804, -11640, -1996, -940, -2510, 1288, 160, 714, 64, -238, -2090, -300, 672, 1542, 32, 1234, -806, 812, 506, 246, 1800, -7754, 1102, 92, -4780, -600, -552, 224, 1216, 100, -976, -408, -148, 612, 276, 832, -1564, -402, -130, 472, 1042, -254, 
1172, -238, -182, -2002, -516, -1236, 474, 8, 88, 962, -1658, 1318, -106, -1190, -956, 318, 912, -292, 1240, -1802, -1516, -726, -558, 762, 1496, -282, 286, -5136, -2362, 1250, 10258, -5758, 948, 5900, 1224, 854, -536, 508, 592, 832, 2164, 1272, 200, 312, -1032, 650, -342, 2208, 598, -290, -1956, 450, -524, -310, 1122, 256, 1172, 1078, 390, -236, -44, -1130, 198, -154, -804, 836, -1206, 816, -432, -916, 270, -220, 880, -306, -1472, -782, 346, 552, -656, 110, 1424, -504, -100, -1106, 706, 46, -516, -108, -244, 222, -1218, -524, 1526, 64, -766, 302, 124, 268, 934, 136, -480, -740, -2018, 274, 526, -454, -664, -300, 36, -250, 250, -192, 578, -624, -162, 56, 270, -684, -750, -44, 560, -810, -270, -674, 90, 336, 642, -450, 404, 330, 592, 496, -408, -428, -238, 708, 1774, 316, 2328, -770, -1178, 4, -56, -652, -316, 1026, 190, 758, -450, 12, 788, 238, 282, 482, 40, 572, -592, 518, 86, -182, 308, 122, 66, -574, -14, 488, -356, -382, 484, -88, -48, 278, -82, -410, 210, 602, 62, 402, 174, -172, -414, -766, -122, 418, 200, 30, -322, -492, 416, 214, 292, 146, 430, -204, -266, 328, 446, -450, -642, -230, -114, -166, -318, -30, 486, 288, 44, -12, 34, -156, -10, -866, 530, 184, 464, 152, 342, 530, -166, -330, -180, -446, -396, 94, 58, 144, -84, 392, 228, -350, -202, 380, 274, -258, 198, 46, 470, 220, -22, -404, -448, -180, 348, 456, -376, -190, 216, -20, -48, -122, 272, 72, -64, -74, 182, 84, -24, 122, 252, 176, 230, -172, 
-54, -12, 582, 162, 220, 46, -228, 634, -30, 256, -94, 242, -238, -206, 280, -18, -380, -46, -388, 114, 32, 398, -208, -406, 40, -248, 414, -238, -52, -186, 272, -94, -140, 130, 490, -180, -122, 94, 2, -318, 88, 128, 182, -112, 48, -106, 280, 128, 290, 228, 204, -2, 160, 210, 94, -122, -76, 124, -42, 50, 38, 376, -334, -104, 200, 22, -8, -342, -38, 140, 8, 326, 84, 48, -4, 32, -204, -98, 84, -32, 26, -454, 276, 92, -144, -148, -32, 596, 88, 78, -122, -494, 438, 318, -260, -308, 412, 102, -76, 106, 202, 180, -164, 4, 462, 54, -420, 
-180, 84, -250, 480, 592, 234, 374, -410, 494, -86, 248, 8, -364, -368, -434, 228, 200, -386, -164, 290, 202, -102, -336, 280, -146, -150, -184, 446, 80, 350, -62, -56, 418, -396, -104, 650, -16, 40, 40, 26, -28, 272, 356, 310, 208, 32, 134, -70, 72, -232, -200, -52, 276, -144, -102, -22, -166, -56, 406, -518, -194, 76, 702, 286, -648, 210, 168, 194, -98, 
336, -98, -134, -474, -234, 508, -172, 40, -156, 48, 376, 72, -80, 116, -580, 506, -2, 330, 8, -434, 24, -460, -470, -86, -164, -66, -178, -696, 446, 52, 200, -364, 400, 58, 766, 
-114, -342, 824, 58, -392, 484, -48, 424, -180, -486, 306, -188, 342, 700, 2, -484, 300, 388, -162, 468, 232, 392, -52, 206, 90, -748, 222, -94, 556, 324, -390, 388, 290, -278, 290, -288, -32, 672, 450, 470, 164, -298, -454, 190, 500, -440, -312, -574, 94, -80, 236, 526, 158, 82, -56, 322, 540, -376, -450, 0, 1004, -40, 74, -344, -896, 592, 338, -870, -572, 82, 656, -168, 456, 544, -450, -378, 314, 118, 290, -428, -412, 510, -162, -684, 744, -1008, -152, -1270, -544, 532, -110, -20, -920, -188, 260, 364, -670, 442, -486, 482, -586, -58, 370, 916, -856, 88, 292, 642, 566, 90, -236, -106, 44, -162, 410, 484, -52, 528, 866, 754, 306, -336, 186, -900, 686, 70, -56, -70, 396, 152, -802, 530, 84, 226, 768, -50, -266, -576, 264, -758, 428, 308, 40, 268, -752, 636, 1180, 176, -642, 404, -52, 104, 934, -788, -406, 920, -88, -306, 522, 236, 108, -336, 52, -758, 646, 20, 116, -414, 642, -144, 
-894, 486, 638, 540, -654, -596, -792, 1078, 640, 336, -116, -390, 408, -864, -52, 442, 316, -456, -1474, -126, 188, -954, 1342, 4, 146, -746, 466, 1228, -636, -1300, 56, 1290, -644, 600, 80, 182, -1090, -756, -918, -570, -442, 1278, 636, 388, 592, 476, 1376, -1866, 256, -612, 166, 230, 226, 476, 1170, 574, -656, -446, -858, -438, -1066, -1116, 708, 476, -298, -348, 546, -44, -130, 1196, 854, -946, -330, 238, 316, 476, 48, -1032, -892, -182, 534, 966, -24, 1106, 156, -304, 76, 350, 170, -378, 984, -1202, -630, 726, -30, -1108, 198, -260, 242, 48, -182, 516, -984, 1446, 254, 826, -94, 514, 1360, 114, -926, 1578, -412, 2432, -540, -1314, 56, 34, -1998, -1784, 4638, 756, 3456, 1146, -786, -966, -824, 460, 1024, 694, 478, -682, 1010, 566, 108, -1338, -876, -1212, 602, 76, -1358, -1038, 624, 42, -430, -578, 982, -328, 420, -694, -346, 58, -1024, -742, 1294, 674, -3212, -1266, -710, -8, 1882, 230, -92, 614, -1092, -242, 2224, -848, -1596, 272, -562, -592, -806, -260, 496, -1384, -358, -542, 1920, 402, -1110, 1184, 486, -1326, -2498, -338, 1448, -148, -52, -1322, -614, 1642, -1550, 1208, -806, -340, 238, -1658, 208, -186, 522, 1424, 1496, 364, 1632, -882, -1014, 836, -2894, -596, 758, 3394, -640, 826, -1662, 642, 406, 1824, 2780, 1354, 794, 704, -520, 1082, 1512, 7956, 1174, -7666, 13512, 1530, -3076, -6726, 336, -456, 2100, 1054, -940, -782, -1906, -2354, 1368, -444, 1134, 500, -1286, -1408, -262, 1512, -2226, 1570, -28, 66, 560, -1240, -418, -2588, -112, -88, 1204, -392, 1662, 456, -180, -500, -1766, 814, 398, 586, -228, -330, -1422, 154, 1712, 152, -886, -694, -5454, -2, 1016, -8922, 1816, 434, 326, 1146, -940, 1344, 104, 1786, 660, -212, -2342, -120, -80, 1036, 274, 1720, -2740, -952, -1874, -12390, 3040, -2572, 474, -110, 324, -942, -212, -304, 1398, -1814, 554, 1278, 660, -936, 2238, -6840, 5286, 820, 2318,
]


# Get unfiltered signal
signalNoise = [
]
try:
    with open(f"{SCRIPT_DIR}/Test5.txt", "r+") as file:
        temp = file.readline()[1:-1]
        tempProcessed = temp.split(",")

        for value in tempProcessed:
            signalNoise += [int(value)]
except:
    print("Run Test5 first")


# Plot signal to see
t = list(range(0, len(signal)))
pyplot.plot(t, signal, "b", label="Filtered Signal")
t = list(range(0, len(signalNoise)))
pyplot.plot(t, signalNoise, "c", label="Noisy Signal")
pyplot.title("Before and after filtering")
pyplot.legend()
pyplot.show()
