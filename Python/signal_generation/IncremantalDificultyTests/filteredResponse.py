# Seting upp libraries
import os
import sys

SCRIPT_DIR = os.path.dirname(os.path.abspath(__file__))
sys.path.append(os.path.dirname(SCRIPT_DIR))

import matplotlib.pyplot as pyplot

# Filtered signal
signal = [
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, -7, -25, -61, -113, -166, -193, -163, -54, 134, 372, 606, 773, 823, 738, 540, 285, 45, -114, -151, -62, 117, 318, 461, 481, 353, 104, -195, -455, -603, -609, -493, -309, -114, 62, 231, 439, 737, 1143, 1615, 2052, 2329, 2355, 2129, 1766, 1473, 1475, 1917, 2784, 3879, 4876, 5431, 5309, 4479, 3140, 1665, 480, -81, 104, 892, 1912, 2685, 2790, 2019, 463, -1506, -3355, -4572, -4846, -4180, -2895, -1520, -605, -523, -1334, -2762, -4294, -5365, -5562, -4773, -3227, -1410, 112, 898, 790, -32, -1118, -1914, -1965, -1080, 600, 2655, 4540, 5782, 6147, 5716, 4844, 4019, 3674, 4022, 4976, 6183, 7158, 7467, 6892, 5516, 3696, 1933, 688, 212, 454, 1082, 1609, 1578, 737, -860, -2864, -4752, -6015, -6344, -5746, -4546, -3272, -2464, -2477, -3351, -4795, -6290, -7274, -7342, -6389, -4645, -2590, -780, 353, 654, 295, -296, -602, -218, 989, 2822, 4822, 6437, 7228, 7033, 6027, 4657, 3477, 2945, 3256, 4272, 5574, 6616, 6923, 6261, 4719, 2675, 660, -829, -1501, -1368, -733, -73, 140, -384, -1642, -3336, -4982, -6090, -6347, -5734, -4534, -3229, -2323, -2154, -2764, -3877, -4997, -5593, -5302, -4071, -2182, -150, 1465, 2261, 2138, 1333, 335, -288, -90, 1092, 3072, 5369, 7365, 8514, 8530, 7486, 5785, 4011, 2713, 2203, 2446, 3084, 3584, 3452, 2431, 608, -1609, -3634, -4912, -5116, -4261, -2696, -980, 311, 776, 313, -864, -2317, -3550, -4189, -4112, -3482, -2672, -2111, -2111, -2741, -3796, -4871, -5511, -5380, -4387, -2723, -795, 918, 2034, 2400, 2139, 1595, 1196, 1287, 1995, 3176, 4464, 5404, 5620, 4957, 3546, 1767, 121, -943, -1184, -651, 339, 1320, 1852, 1687, 862, -317, -1395, -1947, -1747, -861, 371, 1456, 1926, 1509, 232, -1580, -3411, -4733, -5193, -4737, -3623, -2317, -1313, -946, -1268, -2033, -2797, -3094, -2620, -1353, 436, 2284, 3711, 4403, 4334, 3780, 3218, 3145, 3882, 5434, 7459, 9362, 10485, 10327, 8717, 5880, 2373, -1086, -3837, -5470, -5926, -5476, -4589, -3739, -3222, -3050, -2961, -2542, -1419, 559, 3215, 6063, 8447, 9749, 9589, 7946, 5160, 1818, -1432, -4073, -5852, -6813, -7224, -7429, -7682, -8026, -8264, -8035, -6968, -4856, -1782, 1854, 5423, 8243, 9783, 9823, 8513, 6309, 3810, 1555, -145, -1280, -2096, -2952, -4134, -5698, -7405, -8778, -9264, -8441, -6192, -2780, 1205, 5011, 7945, 9573, 9830, 9004, 7603, 6155, 5014, 4243, 3616, 2737, 1230, -1072, -4012, -7114, -9710, -11146, -10996, -9209, -6137, -2433, 1146, 3964, 5681, 6318, 6192, 5750, 5368, 5194, 5095, 4726, 3692, 1738, -1108, -4496, -7836, -10472, -11884, -11844, -10471, -8169, -5476, -2882, -681, 1091, 2613, 4152, 5905, 7873, 9817, 11314, 11894, 11209, 9173, 6022, 2270, -1426, -4448, -6385, -7130, -6873, -5996, -4911, -3902, -3030, -2135, -934, 821, 3187, 5941, 8599, 10543, 11214, 10301, 7856, 4292, 263, -3531, -6545, -8526, -9542, -9899, -9981, -10073, -10233, -10262, -9785, -8414, -5932, -2427, 1678, 5717, 8968, 10869, 11185, 10067, 7984, 5554, 3336, 1658, 541, -255, -1083, -2219, -3707, -5301, -6529, -6857, -5892, -3547, -106, 3835, 7531, 10299, 11706, 11672, 10456, 8534, 6415, 4461, 2776, 1203, -571, -2845, -5735, -9070, -12394, -15078, -16507, -16279, -14346, -11045, -7006, -2969, 425, 2799, 4109, 4600, 4670, 4693, 4865, 5129, 5207, 4728, 3405, 1194, -1629, -4510, -6771, -7824, -7365, -5474, -2583, 674, 3671, 5982, 7487, 8359, 8944, 9583, 10444, 11427, 12177, 12202, 11056, 8522, 4728, 151, -4497, -8466, -11181, -12398, -12249, -11163, -9694, -8320, -7286, -6546, -5822, -4755, -3089, -816, 1773, 4152, 5720, 6003, 4826, 2392, -762, -3920, -6401, -7758, -7892, -7042, -5658, -4208, -2994, -2046, -1133, 115, 2023, 4697, 7929, 11221, 13922, 15430, 15387, 13797, 11023, 7664, 4358, 1584, -465, -1895, -3011, -4148, -5501, -7020, -8410, -9237, -9100, -7803, -5460, -2490, 496, 2875, 4195, 4297, 3337, 1706, -119, -1739, -2956, -3813, -4537, -5407, -6598, -8063, -9502, -10436, -10364, -8948, -6158, -2320, 1956, 5948, 9035, 10875, 11484, 11189, 10476, 9793, 9382, 9201, 8963, 8274, 6815, 4498, 1538, -1585, -4262, -5944, -6319, -5414, -3585, -1399, 549, 1819, 2247, 1966, 1323, 723, 456, 571, 846, 868, 196, -1450, -4044, -7212, -10317, -12648, -13648, -13096, -11173, -8387, -5386, -2732, -722, 677, 1759, 2910, 4412, 6299, 8320, 10021, 10913, 10661, 9222, 6879, 4159, 1666, -108, -925, -848, -183, 655, 1299, 1555, 1456, 1230, 1195, 1618, 2588, 3950, 5327, 6227, 6201, 4999, 2669, -437, -3756, -6679, -8734, -9724, -9769, -9235, -8574, -8136, -8027, -8070, -7885, -7055, -5312, -2672, 531, 3725, 6268, 7648, 7647, 6411, 4399, 2228, 469, -531, -736, -389, 121, 438, 392, 67, -239, -143, 656, 2236, 4391, 6673, 8524, 9453, 9197, 7808, 5633, 3193, 1003, -601, -1564, -2107, -2618, -3479, -4894, -6782, -8777, -10338, -10932, -10226, -8218, -5258, -1950, 1031, 3143, 4130, 4072, 3318, 2332, 1512, 1050, 884, 756, 349, -552, -1939, -3549, -4935, -5614, -5237, -3719, -1281, 1612, 4396, 6585, 7916, 8408, 8314, 7987, 7715, 7592, 7477, 7057, 5987, 4050, 1275, -2029, -5334, -8031, -9603, -9779, -8618, -6493, -3976, -1660, 20, 905, 1130, 1039, 1029, 1379, 2127, 3042, 3703, 3659, 2612, 554, -2195, -5066, -7411, -8704, -8702, -7510, -5528, -3300, -1320, 133, 1071, 1757, 2566, 3801, 5536, 7548, 9367, 10428, 10270, 8708, 5915, 2385, -1210, -4219, -6199, -7026, -6892, -6193, -5353, -4653, -4131, -3590, -2708, -1205, 999, 3699, 6429, 8589, 9631, 9238, 7433, 4580, 1275, -1835, -4242, -5712, -6320, -6376, -6272, -6308, -6562, -6853, -6812, -6035, -4262, -1515, 1859, 5262, 8016, 9573, 9688, 8490, 6422, 4072, 1961, 370, -726, -1595, -2587, -3945, -5665, -7459, -8835, -9264, -8373, -6094, -2715, 1185, 4897, 7785, 9462, 9879, 9299, 8168, 6932, 5869, 4999, 4105, 2855, 976, -1588, -4597, -7550, -9825, -10875, -10410, -8499, -5554, -2201, 913, 3308, 4790, 5464, 5642, 5684, 5832, 6099, 6255, 5916, 4704, 2419, -840, -4652, -8364, -11269, -12812, -12752, -11222, -8665, -5671, -2778, -312, 1677, 3365, 5017, 6822, 8766, 10594, 11877, 12160, 11136, 8781, 5399, 1559, -2055, -4832, -6398, -6702, -5996, -4719, -3328, -2137, -1221, -418, 573, 2035, 4076, 6532, 8970, 10797, 11442, 10549, 8111, 4492, 325, -3677, -6929, -9127, -10294, -10708, -10745, -10701, -10662, -10470, -9795, -8283, -5724, -2179, 1980, 6136, 9584, 11731, 12271, 11272, 9142, 6485, 3899, 1791, 276, -805, -1759, -2861, -4194, -5573, -6585, -6733, -5631, -3176, 369, 4415, 8201, 11012, 12386, 12237, 10850, 8751, 6502, 4499, 2848, 1363, -315, -2525, -5395, -8730, -12027, -14617, -15883, -15472, -13421, -10151, -6334, -2685
]


# Get unfiltered signal
signalNoise = [
    -130, 894, -1022, -1133, 723, 180, 19, 939, 826, -1356, 78, -299, -625, 1290, -805, 565, -506, 962, -1410, 149, -1396, -860, 330, 1699, -1145, 852, 1880, -979, 978, 480, -332, 499, 115, 1410, -131, -155, 1082, 618, 398, -214, -891, -191, -795, 391, 490, 490, -21, -2119, -848, 279, -406, 217, 2209, 2659, 3522, 4776, 720, -730, 472, 1182, -184, 3139, 7615, 7265, 7406, 4571, 1921, 2158, 845, 314, 228, 1566, 2464, 4318, 5343, 4504, 1290, -227, -4180, -5086, -4286, -3278, -2311, 2233, -1758, 299, -633, -3882, -5997, -7193, -6126, -5309, -2984, 190, -923, 1434, 1767, -2717, -3498, -4830, -3857, -1392, 997, 2775, 3250, 6038, 4819, 4284, 2484, 1065, 3544, 2788, 6128, 8821, 7185, 9280, 8245, 6751, 2731, 2305, 1281, -485, 3248, 4475, 3600, 4572, 2220, 1111, -2515, -5022, -6820, -5416, -4501, -3096, -2387, -439, -2720, -1666, -6144, -9069, -8594, -7711, -7328, -5614, -2076, -87, -2223, 102, -1704, -3780, -2556, -4123, -1175, 3902, 4749, 7271, 7570, 5088, 5685, 2909, 2123, 2818, 2460, 5599, 7778, 7509, 9358, 7521, 4796, 2414, 2200, -615, 184, 405, 1463, 2885, 1216, 1542, -77, -3989, -5836, -7277, -7490, -4625, -2561, -2219, -1749, -2158, -3616, -3988, -7256, -8471, -7240, -5263, -2903, 1278, 1918, 1189, -25, -457, -1645, -2544, -2246, 335, 1460, 5633, 6526, 8791, 8805, 7424, 5235, 2697, 2210, 2246, 4312, 5629, 8983, 6779, 3867, 552, -805, -2204, -6510, -4014, -2146, -2674, -124, 994, -266, -958, -684, -3278, -5571, -2423, -3290, -2691, -371, 285, -1901, -2367, -5216, -7042, -6741, -7266, -4361, -3359, -2020, 523, 1444, 1503, 248, -2408, -2289, 1248, 1923, 2212, 5829, 6756, 6781, 6119, 3168, 3025, -120, -1180, 146, -824, 2883, 2360, 4688, 2381, -238, -710, -4338, -2751, -2169, 478, 1255, 4244, 3361, 1945, -168, -2891, -2004, -4186, -5545, -5866, -576, -69, -814, -235, -3213, -4905, -4046, -5480, -4419, -3061, 579, 2200, 4283, 3719, 1945, 294, 1331, 1640, 633, 3396, 8099, 10426, 11784, 11846, 11925, 8461, 3420, 1133, 167, -3215, -1877, -2691, -2598, -2199, -3326, -4841, -6697, -7782, -4842, -3890, -333, 4065, 9445, 9622, 9357, 7628, 7504, 3476, 1592, 601, -1755, -2028, -2950, -4427, -5040, -9104, -9462, -11612, -11686, -9497, -7373, -505, 3008, 5803, 8030, 8522, 6870, 6292, 5190, 3087, 3914, 2491, 3092, 2718, -113, -3348, -6488, -9493, -10959, -13654, -9076, -7317, 78, 2652, 4007, 4957, 8142, 5995, 6194, 6216, 5548, 7762, 8434, 7763, 7364, 3379, -972, -4664, -8528, -11965, -9968, -11141, -8600, -4481, -1841, 816, 1399, 2681, 2180, 1037, 5352, 4875, 9568, 8322, 9429, 5778, 2370, -634, -4857, -9941, -10990, -7794, -11890, -7374, -7438, -5065, -6103, -4418, -3174, -746, 33, 4905, 7236, 12740, 13081, 12802, 12460, 10465, 4555, 2724, -617, -3737, -3280, -4171, -4126, -2727, -5964, -5914, -6748, -5692, -4000, -2100, 2387, 6830, 10791, 12187, 12539, 9858, 6285, 3685, 1021, -2550, -3354, -4468, -5310, -5494, -10297, -10499, -12850, -13202, -13102, -13521, -6374, -3519, 2564, 7125, 8004, 9885, 7920, 6964, 6268, 4878, 6959, 4205, 2983, 5047, 2326, -32, -6865, -7135, -9432, -9093, -6409, -3946, 804, 5924, 5750, 9134, 9823, 8366, 8054, 7971, 7748, 7164, 4888, 7848, 3964, 137, -4596, -9533, -13500, -14817, -17554, -17573, -14542, -8234, -7261, -3725, -2646, -783, -489, 1443, 2676, 3587, 6372, 8317, 9015, 6513, 6247, 877, -1845, -7110, -8387, -7412, -7474, -1372, 60, 372, 1169, 2302, 2707, 4390, 7526, 8171, 10966, 13349, 16369, 15345, 11705, 11805, 5525, -295, -5613, -7077, -8573, -8939, -6793, -9406, -9481, -10156, -9724, -10522, -9756, -8396, -4429, -405, 4289, 4398, 7218, 5682, 3436, 1294, -1733, -5087, -6095, -4425, -4361, -4875, -3874, -4169, -5655, -6952, -4884, -4427, -47, 4429, 7946, 12834, 15304, 15674, 13956, 11933, 10505, 7435, 4381, 5408, 3655, 4557, 147, -2355, -5854, -8466, -10140, -12634, -10225, -7455, -5330, -303, 2225, -99, 4393, 958, 210, 1430, 482, -288, 283, -1852, 118, -3507, -5536, -11261, -10151, -14942, -12330, -10800, -5987, -1458, 2312, 4653, 7006, 8635, 5609, 8108, 8545, 11429, 10406, 13115, 13317, 11457, 6656, 5828, 1741, -3347, -4606, -5140, -4953, -2619, -2084, 283, 1416, -449, -1713, -1132, -484, 802, 191, 3106, 3651, 6084, 3440, -1111, -3937, -8621, -11987, -14162, -12462, -12357, -7929, -6275, -4384, -7103, -5168, -4676, -2491, -251, 3205, 8850, 9801, 11854, 12244, 9971, 8163, 6067, 1755, 3166, 1249, 990, 3543, 2112, 1696, -655, 849, -2450, -263, 368, 813, 1493, 7126, 7468, 7389, 9004, 4843, 2174, -746, -3533, -6720, -7298, -6837, -5700, -6945, -7094, -7536, -11579, -13070, -12132, -9067, -6370, -1607, 2590, 3346, 5040, 6769, 6920, 3810, 2645, 1081, 834, 1731, 3399, 3020, 2169, 303, -2276, -1761, -5417, -833, -247, 3772, 6571, 6911, 10256, 8641, 9134, 6053, 4490, 2848, 388, 2373, 2557, 2267, 1123, -1269, -5986, -7798, -10754, -13059, -11811, -10978, -7436, -3460, -716, -447, 1300, 1680, -76, 584, 1532, 1145, 5536, 3463, 3722, 2495, -394, -3218, -6033, -5102, -8790, -4224, -3906, -119, 2287, 4438, 4997, 4697, 4736, 6022, 5737, 9005, 9822, 11728, 10910, 8630, 3979, 1391, -1664, -4908, -8485, -6894, -10003, -8714, -4280, -1833, -1747, -2338, -2560, -2756, -2331, -267, 2231, 2833, 7330, 5150, 7517, 2032, 945, -3728, -7890, -7338, -6765, -6664, -6061, -3599, -2990, -3506, -1754, -4035, -2554, 187, 2206, 5620, 9679, 12755, 11737, 12573, 7456, 3765, 2147, -587, -1994, -4413, -3757, -3085, -2903, -6445, -5761, -8275, -8365, -5802, -1889, -662, 4466, 9448, 8803, 10452, 7682, 5873, 5961, -360, -1300, -1388, -2137, -3180, -1688, -5838, -6530, -8300, -10999, -9575, -9001, -5747, -1494, 2171, 6860, 9283, 7811, 6885, 6414, 3764, 2844, 4046, 4726, 3930, 4278, -1482, -3134, -7581, -9983, -11609, -9918, -9037, -6245, -3702, 2530, 4369, 7010, 5850, 6706, 6501, 6359, 7685, 8522, 8679, 8284, 7186, 3337, -2638, -5683, -7753, -11964, -9470, -9427, -7983, -4004, -2691, 1128, -461, 1210, 525, 3681, 4930, 6964, 7690, 8784, 11481, 7230, 2919, -268, -4447, -8938, -11851, -10738, -11717, -9081, -5837, -6715, -5287, -4682, -3259, -1492, 2842, 5607, 9185, 12485, 13760, 14598, 11802, 8388, 4933, 1030, -341, -4151, -3384, -5095, -1878, -3591, -2864, -5153, -4616, -4972, -1603, -290, 2819, 7193, 10854, 13025, 12937, 11453, 8401, 1539, 60, -1792, -3587, -5137, -4979, -7367, -9660, -11847, -12862, -14050, -14628, -11049, -6243, -4560, 3111, 4828, 10060, 10895, 10589, 9163, 5675, 5194, 5644, 5784, 3936, 3778, 1379, -1045, -5890, -6996, -9939, -8699, -8338, -2745, 921, 6510, 6475, 9831, 10670, 11034, 6981, 5978, 7532, 8628, 7924, 6853, 3137, 139, -4003, -9094, -13298, -17558, -15587, -15236, -12033, -6698, -6676, -5836, -2363, -3622, 681, 530, 1191, 5679, 6872, 8398, 4861, 7697, 5942, 2487, -3810, -6715, -10835, -9078, -7244, -3703, -1184, 1840, 1724, 3223, 2417, 6323, 6405, 9152, 11849, 13893, 15181, 14855, 12072, 9928, 5284, -1269, -4471, -7093, -8943, -7440, -9189, -8047, -8161, -9531, -12112, -10840, -11430, -8541, -3839, 261, 3803, 6573, 7959, 4763, 1528, -13, -4000, -5040, -5259

]
try:
    with open(f"{SCRIPT_DIR}/Test4.txt", "r+") as file:
        temp = file.readline()[1:-1]
        tempProcessed = temp.split(",")

        for value in tempProcessed:
            signalNoise += [int(value)]
except:
    print("Run Test4 first")


# Plot signal to see
t = list(range(0, len(signal)))
pyplot.plot(t, signal, "b", label="Filtered Signal")
t = list(range(0, len(signalNoise)))
pyplot.plot(t, signalNoise, "c", label="Noisy Signal")
pyplot.title("Before and after filtering")
pyplot.legend()
pyplot.show()
